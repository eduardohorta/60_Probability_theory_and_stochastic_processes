\documentclass[12pt]{article}
\usepackage{pmmeta}
\pmcanonicalname{3DistributedDynamicalSystems}
\pmcreated{2014-04-30 18:41:46}
\pmmodified{2014-04-30 18:41:46}
\pmowner{rspuzio}{6075}
\pmmodifier{rspuzio}{6075}
\pmtitle{3. Distributed dynamical systems}
\pmrecord{15}{88087}
\pmprivacy{1}
\pmauthor{rspuzio}{6075}
\pmtype{Feature}
\pmclassification{msc}{60J20}
\pmclassification{msc}{81P15}
\pmclassification{msc}{18F20}

\endmetadata

% this is the default PlanetMath preamble.  as your knowledge
% of TeX increases, you will probably want to edit this, but
% it should be fine as is for beginners.

% almost certainly you want these
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}

% need this for including graphics (\includegraphics)
\usepackage{graphicx}
% for neatly defining theorems and propositions
\usepackage{amsthm}

% making logically defined graphics
%\usepackage{xypic}
% used for TeXing text within eps files
%\usepackage{psfrag}

% there are many more packages, add them here as you need them

\usepackage{enumerate}

% define commands here

\DeclareMathOperator{\Hom}{Hom}

\newcommand{\vecify}{{\mathcal V}}
\newcommand{\Act}{{A}}
\newcommand{\act}{{a}}
\newcommand{\Sit}{{S}}
\newcommand{\occ}{{v}}
\newcommand{\univ}{{\mathbf D}}
\newcommand{\uout}{{d_{out}}}
\newcommand{\uin}{{d_{in}}}
\newcommand{\mangle}{{\mathbf C}}

\newcommand{\psheaf}{{\mathcal F}}
\newcommand{\scat}{{\mathtt{Stoch}}}
\newcommand{\subs}{{\mathtt{Sys}}}
\newcommand{\mcat}{{\mathtt{Meas}}}
\newcommand{\eop}{{$\blacksquare$}}
\newcommand{\eod}{{${}$\\}}
\newcommand{\bra}{{\langle}}
\newcommand{\ket}{{\rangle}}

\newcommand{\cN}{{\mathcal N}}
\newcommand{\bR}{{\mathbb R}}
\newcommand{\fm}{{\mathfrak m}}
\newcommand{\cP}{{\mathcal P}}

\newtheorem{thm}{Theorem}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{remark}
\newtheorem{eg}{Example}
\newtheorem{rem}{Remark}
\newtheorem{defn}{Definition}
\setcounter{eg}{1}
\setcounter{rem}{1}
\setcounter{defn}{3}
\setcounter{thm}{3}
\begin{document}
Probabilistic cellular automata provide useful toy models of a 
wide range of physical and biological systems. A cellular 
automaton consists of a collection of cells, each equipped with 
neighbors. Two important important examples are

\begin{eg}[Conway's game of life]
    The cellular automaton is a grid of deterministic cells 
    with outputs $\{0,1\}$. A cell outputs 1 at time $t$ iff: 
    (i) three of its neighbors outputted 1s at time $t-1$ or 
    (ii) it and two neighbors outputted 1s at $t-1$. Remarkably,
    a sufficiently large game of life grid can implement any 
    deterministic computation \cite{berlekamp:82}. 
\end{eg}

\begin{eg}[Hopfield networks]
	These are probabilistic cellular automata \cite{hopfield:82, amit:89}, again with outputs $\{0,1\}$. Cell $n_k$ fires with probability proportional to 
\begin{equation*}
	p(n_{k,t}=1|n_{\bullet,t-1})\propto \exp\left[\frac{1}{T}
    \sum_{j\rightarrow k}\alpha_{j k}\cdot n_{j,{t-1}}\right].
\end{equation*}
%where $Z$ is a normalizing factor. 
Temperature $T$ controls network stochasticity. Attractors 
$\{\xi^1,\ldots,\xi^N\}$ are embedded into a network by setting 
the connectivity matrix as $\alpha_{j k}=\sum_{\mu=1}^N 
(2\xi_j^\mu-1)(2\xi_k^\mu-1)$.
\end{eg}

It is useful to take a finer perspective on cellular automata 
by decomposing them into spacetime coordinates or occasions 
\cite{balduzzi:11}. An occasion $\occ_l=n_{i,t}$ is a cell 
$n_i$ at a time point $t$. Two occasions are linked $\occ_k
\rightarrow \occ_l$ if there is a connection from $\occ_k$'s 
cell to $\occ_l$'s (because they are neighbors or the same cell)
and their time coordinates are $t-1$ and $t$ respectively for 
some $t$, so occasions form a directed graph. More generally:

\begin{defn}
	\label{d:fds}
	A \emph{distributed dynamical system} $\univ$ consists of 
    the following data:
\end{defn}

\begin{enumerate}[$\univ$1.]
	\item \emph{Directed graph}.
	A graph $G_\univ=(V_\univ,E_\univ)$ with a finite set of 
    vertices or occasions $V_\univ=\{\occ_1\ldots\occ_n\}$ and 
    edges $E_\univ\subset V_\univ\times V_\univ$.
	\item \emph{Alphabets.}
	Each vertex $\occ_l\in V_\univ$ has finite alphabet 
    $\Act_l$ of outputs and finite alphabet $\Sit_l:=
    \prod_{k\in src(l)}A_k$ of inputs, where $src(l)=
    \{\occ_k|\occ_k\rightarrow \occ_l\}$.
	\item \emph{Mechanisms.}
	Each vertex $\occ_l$ is equipped with stochastic map 
    $\fm_l:\vecify\Sit_l\rightarrow \vecify\Act_l$.
\end{enumerate}

\begin{figure}
	\centering
	\includegraphics{dds.png}
	\caption{Mapping a cellular automaton to a distributed 
    dynamical system.
%	\footnotesize{
%	(A) A deterministic device can receive 144 inputs and produce 3 outputs. (B): Each input is implicitly assigned to a category (shaded areas). The information generated by the dark gray output is $\log_2 144-\log_2 9= 4$ bits.
%	}
	}
	\label{f:dds}
\end{figure}

Taking any cellular automaton over a finite time interval 
$[t_\alpha,t_\omega]$ initializing the mechanisms at time 
$t_\alpha$ with fixed values (initial conditions) or 
probability distributions (noise sources) yields a distributed 
dynamical system, see Fig.~\ref{f:dds}. Each cell of the 
original automaton corresponds to a series of occasions in 
the distributed dynamical system, one per time step.

Cells with memory -- i.e. whose outputs depend on their 
neighbors outputs over multiple time steps -- receive inputs 
from occasions more than one time step in the past. If a cell's 
mechanism changes (learns) over time then different mechanisms 
are assigned to the cell's occasions at different time points.

The sections below investigate the compositional structure of 
measurements: how they are built out of submeasurements. 
Technology for tracking subsystems and submeasurements is 
therefore necessary. We introduce two closely related 
categories:

\begin{defn}
    The \emph{category of subsystems} $\subs_\univ$ of $\univ$ 
    is a Boolean lattice with objects given by sets of ordered 
    pairs of vertices $\mangle\in\underline{2}^{V_\univ\times 
    V_\univ}$ and arrows given by inclusions $i_{12}:\mangle_1
    \hookrightarrow \mangle_2$. The initial and terminal 
    objects are $\bot_\univ=\emptyset$ and $\top_\univ=
    V_\univ\times V_\univ$.
\end{defn}

\begin{rem}
	\label{r:subsystems}
	Subsystems are defined as ordered pairs of vertices, 
    rather than subgraphs of the directed graph of $\univ$. 
    Pairs of occasions that are not connected by edges are 
    \emph{ineffective}; they do not contribute to the 
    information-processing performed by the system. We include 
    them in the formalism precisely to make their lack of 
    contribution explicit, see %Remark~\ref{r:same-point}
    \PMlinkname{Remark~3}{4measurement#Thmrem3}.
\end{rem}

Let $src(\mangle)=\{\occ_k|(\occ_k,\occ_l)\in\mangle\}$ and similarly for $trg(\mangle)$. Set the input alphabet of $\mangle$ as the product of the output alphabets of its source occasions $\Sit^\mangle=\prod_{src(\mangle)}A_k$ and similarly the output alphabet of $\mangle$ as the product of the output alphabets of its target occasions $\Act^\mangle=\prod_{trg(\mangle)}A_l$. 
\begin{defn}
	The \emph{category of measuring devices} $\mcat_\univ$ on $\univ$ has objects $\Hom_\scat(\vecify \Act^\mangle,\vecify \Sit^\mangle)$ for $\mangle\in \underline{2}^{V_\univ\times V_\univ}$. For $\mangle_1\hookrightarrow \mangle_2$ define arrow 
	\begin{align*}
		r_{21}:\Hom\left(\vecify \Act^{\mangle_2},\vecify \Sit^{\mangle_2}\right) & \rightarrow \Hom\left(\vecify \Act^{\mangle_1},\vecify \Sit^{\mangle_1}\right)\\
		\left[\vecify \Act^{\mangle_2}\xrightarrow{T}\vecify \Sit^{\mangle_2}\right]
		 & \mapsto \left[\vecify \Act^{\mangle_1}\xrightarrow{\pi^\natural_\Act}
		\vecify\Act^{\mangle_2}\xrightarrow{T}\vecify\Sit^{\mangle_2}
		\xrightarrow{\pi_\Sit}\vecify\Sit^{\mangle_1}
		\right],
	\end{align*}
	where $\pi_A$ and $\pi_S$ are shorthands for projections 
    as in % Definition \ref{eg:det}.
    \PMlinkname{Example 1}{2stochasticmaps#Thmeg1}
\end{defn}

The reason for naming $\mcat_\univ$ the category of measuring 
devices will become clear in %\S\ref{s:measurement} 
\PMlinkname{\S 4}{4measurement}
below. The two categories are connected by contravariant 
functor $\psheaf$:

\begin{thm}
	[structure presheaf]
	\label{t:presheaf}
	The \emph{structure presheaf} $\psheaf$ taking
	\begin{equation*}
		\psheaf_\univ:\subs_\univ^{\mathtt{op}}\rightarrow 
        \mcat_\univ:
		\mangle\mapsto\Hom\left(\vecify\Act^\mangle,
        \vecify\Sit^\mangle\right)
		\mbox{ and }
		i_{12}\mapsto r_{21}
	\end{equation*}
	satisfies the gluing axiom but has non-unique descent.
\end{thm}

\noindent
Proof: Functor $\psheaf$ is trivially a presheaf since it is 
contravariant. It is an \emph{interesting} presheaf because 
the gluing axiom holds. 

For gluing we need to show that for any collection 
$\{\mangle_j\}_{j=1}^l$ of subsystems and sections 
$\fm_j^\natural \in \psheaf_\univ(\mangle_j)$ such that 
$r_{j,ji}(\fm_j^\natural)=r_{i,ji}(\fm_i^\natural)$ 
for all $i$, $j$ there exists section $\fm^\natural\in
\psheaf_\univ\left(\bigcup_{j=1}^l\mangle_j\right)$ such that 
$r_i(\fm^\natural)=\fm^\natural_i$ for all $i$. This reduces 
to finding a conditional distribution that causes diagram 
\begin{figure}
 \centering
 \includegraphics{information-theoretic-distributed-measurement-3.1.png}
\end{figure}
%\begin{equation*}
%    \xymatrix{
%	?\ar[r]\ar[d] & \fm_i\ar[d]\\
%	\fm_j\ar[r] & \fm_{ij}
%	}
%\end{equation*}
in $\mcat_\univ$ to commute. The vertices are conditional distributions and the arrows are marginalizations, so rewrite as
\begin{figure}
 \centering
 \includegraphics{information-theoretic-distributed-measurement-3.2.png}
\end{figure}
%\begin{equation*}
%	\xymatrix{
%	?\ar[r]\ar[d] & p(x,y|u,w)\ar[d]\\
%	p(x,z|v,w)\ar[r] & p(x|w),
%	}
%\end{equation*}
where $p(x|w)=\sum_{v,z}p(x,z|v,w)p^{maxH}(v)$ and similarly 
for the vertical arrow. It is easy to see that
\begin{equation*}
	p(x,y,z|u,v,w):=\frac{p(x,y|u,w)p(x,z|v,w)}{p(x|w)}
\end{equation*}
satisfies the requirement.

For $\psheaf$ to be a sheaf it would also have to satisfy 
unique descent: the section satisfying the gluing axiom must 
not only \emph{exist} for any collection 
$\{\mangle_j\}_{j=1}^l$ with compatible restrictions but must 
also be \emph{unique}. Descent in $\psheaf$ is not unique 
because there are many distributions satisfying the requirement
above: strictly speaking $r$ is a marginalization operator 
rather than restriction. For example, there are many 
distributions $p(y,z)$ that marginalize to give $p(y)$ and 
$p(z)$ besides the product distribution $p(y)p(z)$.
\eop

The structure presheaf $\psheaf$ depends on the graph 
structure and alphabets; mechanisms play no role. We now 
construct a family of sections of $\psheaf$ using the 
mechanisms of $\univ$'s occasions. Specifically, given a 
subsystem $\mangle\in \subs_\univ$, we show how to glue its 
occasions' mechanisms together to form joint mechanism 
$\fm_\mangle$. The mechanism $\fm_\univ=\fm_\top$ of the 
entire system $\univ$ is recovered as a special case. 

In general, subsystem $\mangle$ is not isolated: it receives 
inputs along edges contained in $\univ$ but \emph{not} in 
$\mangle$. Inputs along these edges cannot be assigned a fixed 
value since in general there is no preferred element of 
$\Act_l$. They also cannot be ignored since $\fm_l$ is defined 
as receiving inputs from all its sources. Nevertheless, the 
mechanism of $\mangle$ should depend on $\mangle$ alone. We 
therefore treat edges not in $\mangle$ as sources of extrinsic 
noise by marginalizing with respect to the uniform distribution
as in %Corollary~\ref{t:marginalize}
\PMlinkname{Corollary~3}{2stochasticmaps#Thmthm3}. 

For each vertex $\occ_l\in trg(\mangle)$ let $\Sit^\mangle_l=
\prod_{k\in src(l)\cap src(C)} \Act_k$. We then have projection
$\pi_l:\vecify \Sit_l\rightarrow \vecify \Sit^\mangle_l$. 
Define
\begin{equation}
	\label{e:ind_occ}
	\fm^\mangle_l:=\left[\vecify \Sit^\mangle_l\xrightarrow
    {\pi_l^\natural}\vecify \Sit_l\xrightarrow{\fm_l}
    \vecify\Act_l\right].
\end{equation}
It follows immediately that $\mangle$ is itself a distributed 
dynamical system defined by its graph, whose alphabets are 
inherited from $\univ$ and whose mechanisms are constructed 
by marginalizing.

Next, we tensor the mechanisms of individual occasions and glue
them together using the diagonal map  $\Delta:\Sit^\mangle
\rightarrow \prod_{v_l\in trg(\mangle)}\Sit^\mangle_l$. The 
diagonal map used here\footnote{which is surjective in the 
sense that all rows contain non-zero entries} generalizes 
$X\xrightarrow{\Delta}X\times X$ and removes redundancies in 
$\prod_l \Sit^\mangle_l$, which may, for example, include the 
same source alphabets many times in different factors.

Let mechanism $\fm_\mangle$ be
\begin{equation}
	\label{e:m_mech}
	\fm_\mangle:=\left[\vecify \Sit^\mangle\xrightarrow
    {\iota_\Delta}\bigotimes_{\occ_l\in trg(\mangle)}\vecify 
    \Sit^\mangle_l\xrightarrow{\otimes_{\occ_l\in 
    trg(\mangle)}\fm^\mangle_l}\vecify\Act^\mangle\right].
\end{equation}
The dual of $\fm_\mangle$ is 
\begin{equation}
	\label{e:measurement}
	\fm_\mangle^\natural:=\left[\vecify\Act^\mangle\rightarrow 
    \vecify \Sit^\mangle\right].
\end{equation}

Finally, we find that we have constructed a family of sections 
of $\psheaf$:

\begin{defn}
    \label{d:quale}	
	The \emph{quale} $\mathbf{q}_\univ$ is the family of 
    sections of $\psheaf$ constructed in 
    Eqs.~\eqref{e:ind_occ}, \eqref{e:m_mech} and 
    \eqref{e:measurement}
	\begin{equation*}
		\mathbf{q}_\univ:=\left\{\fm^\natural_\mangle \in 
        \psheaf(\mangle)=
		\Hom\left(\vecify\Act^\mangle,\vecify \Sit^\mangle
        \right)
		\Big|\mangle\in \subs_\univ\right\}.
	\end{equation*}
\end{defn}
The construction used to glue together the mechanism of the 
entire system can also be used to construct the mechanism of 
any subsystem, which provides a window -- the quale -- into 
the compositional structure of distributed processes.

\begin{thebibliography}{10}
%\providecommand{\bibitemdeclare}[2]{}
\providecommand{\urlprefix}{Available at }
\providecommand{\url}[1]{\texttt{#1}}
\providecommand{\href}[2]{\texttt{#2}}
\providecommand{\urlalt}[2]{\href{#1}{#2}}
\providecommand{\doi}[1]{doi:\urlalt{http://dx.doi.org/#1}{#1}}
\providecommand{\bibinfo}[2]{#2}

%\bibitemdeclare{book}{amit:89}
\bibitem{amit:89}
\bibinfo{author}{DJ~Amit} (\bibinfo{year}{1989}):
  \emph{\bibinfo{title}{Modelling brain function: the world of attractor neural
  networks}}.
\newblock \bibinfo{publisher}{Cambridge University Press}.

%\bibitemdeclare{article}{balduzzi:11}
\bibitem{balduzzi:11}
\bibinfo{author}{David Balduzzi} (\bibinfo{year}{2011}):
  \emph{\bibinfo{title}{Detecting emergent processes in cellular automata with
  excess information}}.
\newblock {\sl \bibinfo{journal}{preprint}} .

%\bibitemdeclare{book}{berlekamp:82}
\bibitem{berlekamp:82}
\bibinfo{author}{ER~Berlekamp}, \bibinfo{author}{JC~Conway} \&
  \bibinfo{author}{RK~Guy} (\bibinfo{year}{1982}):
  \emph{\bibinfo{title}{Winning Ways for your Mathematical Plays}}.
\newblock \bibinfo{volume}{2}, \bibinfo{publisher}{Academic Press}.

%\bibitemdeclare{article}{hopfield:82}
\bibitem{hopfield:82}
\bibinfo{author}{JJ~Hopfield} (\bibinfo{year}{1982}):
  \emph{\bibinfo{title}{Neural networks and physical systems with emergent
  computational properties}}.
\newblock {\sl \bibinfo{journal}{Proc. Nat. Acad. Sci.}} \bibinfo{volume}{79},
  pp. \bibinfo{pages}{2554--2558}.
  
\end{document}
